generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Player {
  id             String   @id @default(cuid())
  name           String
  team           String?
  position       String?
  positionRaw    String?
  positionNorm   String?
  nbaPersonId    String   @unique
  instagram      String?
  heightInches   Int?
  heightText     String?

  followers      Int?
  following      Int?
  posts          Int?    // total posts (from profile header)
  avgLikes       Int?
  avgComments    Int?
  engagementRate Float?
  instagramUpdatedAt DateTime?
  igEngagementLastCheckedAt DateTime?
  igEngagementStatus  String?  // e.g. "ok", "private", "unavailable", "rate_limit"
  igSbLastCheckedAt   DateTime?
  igSbStatus          String?  // ok | not_found | blocked | error
  igEngagementRate    Float?   // from SocialBlade (e.g. 8.25)
  igAvgLikes          Float?
  igAvgComments       Float?

  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  partnerships   PlayerPartnership[]

  @@index([team])
  @@index([name])
  @@index([position])
  @@index([heightInches])
}

model PlayerPartnership {
  id                   String   @id @default(cuid())
  playerId             String
  player               Player   @relation(fields: [playerId], references: [id], onDelete: Cascade)
  brand                String
  dates                String
  activationType       String   // Type of Activation
  distribution         String?
  additionalNotes      String?
  playerFee            String?
  caliber              String?
  igFollowersAtTime    Int?
  twitterFollowersAtTime Int?
  reachAtTime          Int?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt

  @@unique([playerId, brand, dates, activationType])
  @@index([playerId])
}